apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    component: sonobuoy
  name: sonobuoy-plugins-cm
  namespace: heptio-sonobuoy
data:
  e2e.yaml: |
    driver: Job
    name: e2e
    resultType: e2e
    spec:
      containers:
      - env:
        - name: E2E_FOCUS
          value: Conformance
        image: gcr.io/heptio-images/kube-conformance:v1.8
        imagePullPolicy: Always
        name: e2e
        volumeMounts:
        - mountPath: /tmp/results
          name: results
      - command:
        - sh
        - -c
        - /sonobuoy worker global -v 5 --logtostderr
        env:
        - name: NODE_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: spec.nodeName
        - name: RESULTS_DIR
          value: /tmp/results
        image: gcr.io/heptio-images/sonobuoy:master
        imagePullPolicy: Always
        name: sonobuoy-worker
        volumeMounts:
        - mountPath: /etc/sonobuoy
          name: config
        - mountPath: /tmp/results
          name: results
      restartPolicy: Never
      serviceAccountName: sonobuoy-serviceaccount
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
      - key: CriticalAddonsOnly
        operator: Exists
      volumes:
      - emptyDir: {}
        name: results
      - configMap:
          name: __SONOBUOY_CONFIGMAP__
        name: config
